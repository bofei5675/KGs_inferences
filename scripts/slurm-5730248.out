Using pretrained: False
number of unique_entities -> 1685
number of unique_entities -> 1539
number of unique_entities -> 1598
Training size 2 Val size 2 Test size 2
Initialised relations and entities randomly
Graph created
length of graph keys is  1685
time taken  86.63097429275513
length of neighbors dict is  1685
Total triples count 192259, training triples 134598, validation_triples 19228, test_triples 38433
Opening node_neighbors pickle object
Initial entity dimensions torch.Size([1710, 50]) , relation dimensions torch.Size([86, 50])
Defining model

Model type -> GAT layer with 2 heads used , Initital Embeddings training
length of unique_entities  1685
Number of epochs 800

epoch->  0
Traceback (most recent call last):
  File "main.py", line 407, in <module>
    train_gat(args)
  File "main.py", line 256, in train_gat
    Corpus_, Corpus_.train_adj_matrix, train_indices, current_batch_2hop_indices)
  File "/scratch/bz1030/anaconda3/envs/capstone/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/bz1030/anaconda3/envs/capstone/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 150, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/scratch/bz1030/anaconda3/envs/capstone/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/bz1030/relationPrediction/models.py", line 146, in forward
    edge_list, edge_type, edge_embed, edge_list_nhop, edge_type_nhop)
  File "/scratch/bz1030/anaconda3/envs/capstone/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/bz1030/relationPrediction/models.py", line 69, in forward
    edge_list_nhop, edge_embed_nhop))
  File "/scratch/bz1030/anaconda3/envs/capstone/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch/bz1030/relationPrediction/layers.py", line 114, in forward
    (input[edge[0, :], :], input[edge[1, :], :], edge_embed[:, :]), dim=1).t()
RuntimeError: CUDA out of memory. Tried to allocate 4.79 GiB (GPU 0; 15.75 GiB total capacity; 10.71 GiB already allocated; 4.01 GiB free; 38.42 MiB cached)
